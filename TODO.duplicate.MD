Remove duplicate code, e.g., the lexhost function and also the pattern for error catching that is repeated in lots of places.
